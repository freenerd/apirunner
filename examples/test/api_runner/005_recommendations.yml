---
- name: "9 ratings in preparation for recommendation check should return a 204"
  request:
    headers:
      Content-Type:         'application/json'
    path:                   '/users/duffyduck/ratings'
    method:                 'PUT'
    body:
      m765: 1.0
      m42: 2.0
      m89: 3.0
      m91: 4.0
      m98: 5.0
      m766: 1.0
      m43: 2.0
      m90: 3.0
      m92: 4.0
  response_expectation:
    status_code: 204
    body:
- name: "There should not be any recommendations and a 204 because there are too few ratings"
  priority: 1
  request:
    headers:
      Content-Type:           'application/json'
    path:                    '/users/duffyduck/recommendations'
    method:                  'GET'
  response_expectation:
    status_code: 204
    body: {}
- name: "There should NOT be a prediction for a certain item"
  priority: 1
  request:
    headers:
      Content-Type:            'application/json'
    path:                      '/users/duffyduck/predictions/items/m965'
    method:                    'GET'
  response_expectation:
    status_code: 204
    body:
- name: "10 ratings in preparation for recommendation check should return a 204"
  request:
    headers:
      Content-Type:         'application/json'
    path:                   '/users/duffyduck/ratings'
    method:                 'PUT'
    body:
      m765: 1.0
      m42: 2.0
      m89: 3.0
      m91: 4.0
      m98: 5.0
      m766: 1.0
      m43: 2.0
      m90: 3.0
      m92: 4.0
      m99: 5.0
  response_expectation:
    status_code: 204
    body:
- name: "With 10 ratings put there should be a lot of recommendations"
  request:
    headers:
      Content-Type:           'application/json'
    path:                     '/users/duffyduck/recommendations'
    method:                   'GET'
  response_expectation:
    status_code: 200
    body:                     /^\[(\{"m\d+":[0-5]\.[05]\},)*\{"m\d+":[0-5]\.[05]\}\]$/
- name: "There should be only 10 recommendations if per_page parameter is set"
  priority: 1
  request:
    headers:
      Content-Type:           'application/json'
    path:                     '/users/duffyduck/recommendations'
    method:                   'GET'
    parameters:
      per_page: 10
  response_expectation:
    status_code: 200
    body:                     /^\[(\{"m\d+":[0-5]\.[05]\},){9}\{"m\d+":[0-5]\.[05]\}\]$/
- name: "There should occure a 404 if recommendations are requested for a non existing user"
  request:
    headers:
      Content-Type:            'application/json'
    path:                      '/users/daisyduck/recommendations'
    method:                    'GET'
  response_expectation:
    status_code: 404
    body:
- name: "There should be a prediction for a certain item"
  request:
    headers:
      Content-Type:            'application/json'
    path:                      '/users/duffyduck/predictions/items/m965'
    method:                    'GET'
  response_expectation:
    status_code: 200
    body:                    /^\[{"m\d+":[0-5]\.[05]}\]$/
- name: "There should occure a 404 if a prediction for y certain item is requested for an unknown user"
  request:
    headers:
      Content-Type:            'application/json'
    path:                      '/users/daisyduck/predictions/items/m965'
    method:                    'GET'
  response_expectation:
    status_code: 404
    body:
